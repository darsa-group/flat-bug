<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Trainers" href="trainers.html" /><link rel="prev" title="Non-maximum suppression" href="nms.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Predictor - flat-bug documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">flat-bug  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">flat-bug  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI API</a></li>
<li class="toctree-l1"><a class="reference internal" href="augmentations.html">Augmentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="coco_utils.html">Coco utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="eval_utils.html">Evaluation utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometric.html">Geometry utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="nms.html">Non-maximum suppression</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Predictor</a></li>
<li class="toctree-l1"><a class="reference internal" href="trainers.html">Trainers</a></li>
<li class="toctree-l1"><a class="reference internal" href="yolo_helpers.html">YOLO helpers</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/predictor.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="predictor">
<h1>Predictor<a class="headerlink" href="#predictor" title="Link to this heading">¶</a></h1>
<section id="tensorpredictions">
<h2><a class="reference internal" href="#flat_bug.predictor.TensorPredictions" title="flat_bug.predictor.TensorPredictions"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorPredictions</span></code></a><a class="headerlink" href="#tensorpredictions" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="flat_bug.predictor.TensorPredictions">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flat_bug.predictor.</span></span><span class="sig-name descname"><span class="pre">TensorPredictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Prepared_Results</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flat_bug.predictor.TensorPredictions" title="Link to this definition">¶</a></dt>
<dd><p>Result handling class for combining the results from multiple YOLOv8 detections at different scales into a single object.</p>
<p><cite>TensorPredictions</cite> handles a rather complex merging procedure, resizing to remove image padding and scaling effects on the masks and boxes, and non-maximum suppression using mask-IoU or mask-IoS.</p>
<p><cite>TensorPredictions</cite> also allows for easy conversion from mask to contours and back, plotting of the results, and (de-)serialization to save and load the results to/from disk.</p>
<dl class="py method">
<dt class="sig sig-object py" id="flat_bug.predictor.TensorPredictions.contour_to_image_coordinates">
<span class="sig-name descname"><span class="pre">contour_to_image_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contour</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#flat_bug.predictor.TensorPredictions.contour_to_image_coordinates" title="Link to this definition">¶</a></dt>
<dd><p>Converts a contour from mask coordinates to image coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contour</strong> (<cite>torch.Tensor</cite>) – The contour to convert.</p></li>
<li><p><strong>scale</strong> (<cite>float</cite>, optional) – The scale factor to apply to the contour. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The contour in image coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>out (<cite>torch.Tensor</cite>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="flat_bug.predictor.TensorPredictions.contours">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">contours</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#flat_bug.predictor.TensorPredictions.contours" title="Link to this definition">¶</a></dt>
<dd><p>This function wraps the openCV.findContours function, and uses openCV.contourArea to select the largest contour for each mask.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flat_bug.predictor.TensorPredictions.fix_boxes">
<span class="sig-name descname"><span class="pre">fix_boxes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#flat_bug.predictor.TensorPredictions.fix_boxes" title="Link to this definition">¶</a></dt>
<dd><p>This function simply sets the boxes to match the masks.</p>
<p>It is not strictly needed, but can be used as a sanity check to see if the boxes match the masks.
The discrepancy between the boxes and the masks comes about by all the scaling and smoothing of the masks.</p>
<p>TODO: Should probably be removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flat_bug.predictor.TensorPredictions.flip">
<span class="sig-name descname"><span class="pre">flip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vertical'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#flat_bug.predictor.TensorPredictions.flip" title="Link to this definition">¶</a></dt>
<dd><p>Flips the masks, polygons and boxes along the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>direction</strong> (<cite>str</cite>, optional) – The axis to flip the masks, polygons and boxes along.
Defaults to “vertical”. Should be one of “vertical”, “y”, “horizontal” or “x”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The <cite>TensorPredictions</cite> object with the masks, polygons and boxes flipped.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>out (<cite>Self</cite>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flat_bug.predictor.TensorPredictions.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#flat_bug.predictor.TensorPredictions.load" title="Link to this definition">¶</a></dt>
<dd><p>Deserializes a TensorPredictions object from a .pt or .json file, or a dictionary. OBS: Mutates and returns the current object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>dict</em><em>]</em>) – The path to the file to load or a dictionary with the deserialized json data.</p></li>
<li><p><strong>device</strong> (<em>Optional</em><em>[</em><em>DeviceLikeType</em><em>]</em><em>, </em><em>optional</em>) – The device to load the data to. Defaults to None. If None, the device is set to “cpu”.</p></li>
<li><p><strong>dtype</strong> (<em>Optional</em><em>[</em><em>torch.types._dtype</em><em>]</em><em>, </em><em>optional</em>) – The data type to load the data as. Defaults to None. If None, the data type is set to torch.float32.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This object with the deserialized data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flat_bug.predictor.TensorPredictions.non_max_suppression">
<span class="sig-name descname"><span class="pre">non_max_suppression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iou_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#flat_bug.predictor.TensorPredictions.non_max_suppression" title="Link to this definition">¶</a></dt>
<dd><p>Simply wraps the <cite>nms_masks</cite> function from yolo_helpers.py, and removes the duplicates from the <cite>TensorPredictions</cite> object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flat_bug.predictor.TensorPredictions.offset_scale_pad">
<span class="sig-name descname"><span class="pre">offset_scale_pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#flat_bug.predictor.TensorPredictions.offset_scale_pad" title="Link to this definition">¶</a></dt>
<dd><p>Since the image may be padded, the masks and boxes should be offset by the padding-width and scaled by
the <cite>scale_before</cite> factor to match the original image size. Also pads the boxes by pad pixels to be safe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>offset</strong> (<cite>torch.Tensor</cite>) – A vector of length 2 containing the x and y offset of the image. Useful for removing image-padding effects.</p></li>
<li><p><strong>scale</strong> (<cite>float</cite>) – The scale factor of the image.</p></li>
<li><p><strong>pad</strong> (<cite>int</cite>, optional) – The number of pixels to pad the boxes by. Defaults to 0. (Not to be confused with image-padding,
this is about expanding the boxes a bit to ensure they cover the entire mask)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The <cite>TensorPredictions</cite> object with the masks, polygons and boxes offset, scaled and padded.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>out (<cite>Self</cite>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flat_bug.predictor.TensorPredictions.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(255,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flat_bug.predictor.TensorPredictions.plot" title="Link to this definition">¶</a></dt>
<dd><p>Visualizes <cite>flatbug</cite> predictions from a <cite>TensorPredictions</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>linewidth</strong> (<cite>int</cite>, optional) – Linewidth of the segmentation countours and bounding boxes. Default to 2.</p></li>
<li><p><strong>masks</strong> (<cite>bool</cite>, optional) – Flag to indicate whether segmentation contours should be included. Default to True.</p></li>
<li><p><strong>boxes</strong> (<cite>bool</cite>, optional) – Flag to indicate whether bounding boxes should be included, if False confidences are also omitted. Defaults to True.</p></li>
<li><p><strong>confidences</strong> (<cite>bool</cite>, optional) – Flag to indicate whether detection confidences should be included, if boxes is False, this argument is ignored. Defaults to True.</p></li>
<li><p><strong>outpath</strong> (<cite>Optional[str]</cite>, optional) – Where should the visualization be saved? If outpath is None, then the rasterized visualization is returned as a <cite>cv2.UMat</cite>/<cite>np.ndarray</cite> (shape: HWC, colors: BGR). Defaults to None.</p></li>
<li><p><strong>scale</strong> (<cite>float</cite>, optional) – Render the visualization at a scale relative to the image size (from which the predictions originate). <strong>OBS</strong>: Large images and/or scales can be very slow to render. Defaults to 1.</p></li>
<li><p><strong>contour_color</strong> (<cite>Tuple[int, int, int]</cite>, optional) – RGB color ([0, 255]) to use for contour border and fill. Defaults to <cite>(255, 0, 0)</cite> (red).</p></li>
<li><p><strong>box_color</strong> (<cite>Tuple[int, int, int]</cite>, optional) – RGB color ([0, 255]) to use for bounding box and confidence text color. Defaults to <cite>(0, 0, 0)</cite> (black).</p></li>
<li><p><strong>alpha</strong> (<cite>float</cite>, optional) – Transparency of the contour fill ([0, 1]). Defaults to 0.3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If outpath is supplied, it is returned, otherwise the rasterized visualization is returned as as a <cite>cv2.UMat</cite>/<cite>np.ndarray</cite> (shape: HWC, colors: BGR).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>out (<cite>Union[cv2.UMat, str]</cite>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flat_bug.predictor.TensorPredictions.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overview</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fast</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_crops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#flat_bug.predictor.TensorPredictions.save" title="Link to this definition">¶</a></dt>
<dd><p>Saves the serialized prediction results, crops, and overview to the given output directory.</p>
<p>TODO: Add the identifier to the names of the files, so that we can save multiple predictions for the same image or images with the same name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_directory</strong> (<cite>str</cite>) – The directory to save the prediction results to.</p></li>
<li><p><strong>overview</strong> (<cite>bool | str</cite>, optional) – Whether to save the overview image. Defaults to True.
If a string is given, it is interpreted as a path to a directory to save the overview image to.</p></li>
<li><p><strong>crops</strong> (<cite>bool | str</cite>, optional) – Whether to save the crops. Defaults to True.
If a string is given, it is interpreted as a path to a directory to save the crops to.</p></li>
<li><p><strong>metadata</strong> (<cite>bool | str</cite>, optional) – Whether to save the metadata. Defaults to True.
If a string is given, it is interpreted as a path to a directory to save the metadata to.</p></li>
<li><p><strong>fast</strong> (<cite>bool</cite>, optional) – Whether to use the fast version of the overview image. Defaults to False.
Saves the overview image at half the resolution.</p></li>
<li><p><strong>mask_crops</strong> (<cite>bool</cite>, optional) – Whether to mask the crops. Defaults to False.</p></li>
<li><p><strong>identifier</strong> (<cite>str | None</cite>, optional) – An identifier for the serialized data. Defaults to None.</p></li>
<li><p><strong>basename</strong> (<cite>str | None</cite>, optional) – The base name of the image. Defaults to None.
If None, the base name is extracted from the image path, which must be set in this case.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The path to the directory containing the serialized data - the crops and overview image(s) are also saved here by default. </dt><dd><p>If the standard location is not used at all, the directory is not created and None is returned instead.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flat_bug.predictor.TensorPredictions.serialize">
<span class="sig-name descname"><span class="pre">serialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_json</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_pt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#flat_bug.predictor.TensorPredictions.serialize" title="Link to this definition">¶</a></dt>
<dd><p>This function serializes the <cite>TensorPredictions</cite> object to a .pt file and/or a .json file.
The .pt file contains an exact copy of the <cite>TensorPredictions</cite> object, while the .json file contains the data in a more human-readable format,
which can be deserialized into a <cite>TensorPredictions</cite> object using the ‘load’ function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outpath</strong> (<em>str</em><em>, </em><em>optional</em>) – The path to save the serialized data to. Defaults to None.</p></li>
<li><p><strong>save_json</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to save the .json file. Defaults to True. Recommended.</p></li>
<li><p><strong>save_pt</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to save the .pt file. Defaults to False. Rather disk space wasteful.</p></li>
<li><p><strong>identifier</strong> (<em>str</em><em>, </em><em>optional</em>) – An identifier for the serialized data. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id1">
<h2><a class="reference internal" href="#flat_bug.predictor.Predictor" title="flat_bug.predictor.Predictor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Predictor</span></code></a><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flat_bug.predictor.</span></span><span class="sig-name descname"><span class="pre">Predictor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'flat_bug_M.pt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flat_bug.predictor.Predictor" title="Link to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.BATCH_SIZE">
<span class="sig-name descname"><span class="pre">BATCH_SIZE</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#flat_bug.predictor.Predictor.BATCH_SIZE" title="Link to this definition">¶</a></dt>
<dd><p>The batch size to use for the prediction. This determines how many tiles are processed in parallel. Increasing this value may improve performance, but will also increase memory usage.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.EDGE_CASE_MARGIN">
<span class="sig-name descname"><span class="pre">EDGE_CASE_MARGIN</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#flat_bug.predictor.Predictor.EDGE_CASE_MARGIN" title="Link to this definition">¶</a></dt>
<dd><p>The margin to add to the edge of the image to catch instances that are split between tiles. The margin is added to the edge of the image, such that instances on the true edge of the images are not removed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.EXPERIMENTAL_NMS_OPTIMIZATION">
<span class="sig-name descname"><span class="pre">EXPERIMENTAL_NMS_OPTIMIZATION</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#flat_bug.predictor.Predictor.EXPERIMENTAL_NMS_OPTIMIZATION" title="Link to this definition">¶</a></dt>
<dd><p>Enables an experimental optimization for the NMS step. This optimization improves the performance of the NMS step when there are many instances in a large image and CUDA is available.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.HYPERPARAMETERS">
<span class="sig-name descname"><span class="pre">HYPERPARAMETERS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['SCORE_THRESHOLD',</span> <span class="pre">'IOU_THRESHOLD',</span> <span class="pre">'MINIMUM_TILE_OVERLAP',</span> <span class="pre">'EDGE_CASE_MARGIN',</span> <span class="pre">'MIN_MAX_OBJ_SIZE',</span> <span class="pre">'MAX_MASK_SIZE',</span> <span class="pre">'PREFER_POLYGONS',</span> <span class="pre">'EXPERIMENTAL_NMS_OPTIMIZATION',</span> <span class="pre">'TIME',</span> <span class="pre">'TILE_SIZE',</span> <span class="pre">'BATCH_SIZE']</span></em><a class="headerlink" href="#flat_bug.predictor.Predictor.HYPERPARAMETERS" title="Link to this definition">¶</a></dt>
<dd><p>The available hyperparameters for the predictor. These can be set using the <cite>set_hyperparameters</cite> class method.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.IOU_THRESHOLD">
<span class="sig-name descname"><span class="pre">IOU_THRESHOLD</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#flat_bug.predictor.Predictor.IOU_THRESHOLD" title="Link to this definition">¶</a></dt>
<dd><p>The IOU threshold used to determine if two instances are duplicates. </p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.MAX_MASK_SIZE">
<span class="sig-name descname"><span class="pre">MAX_MASK_SIZE</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#flat_bug.predictor.Predictor.MAX_MASK_SIZE" title="Link to this definition">¶</a></dt>
<dd><p>Defines the maximum size of the segmentation masks. Only applies if PREFER_POLYGONS is False.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.MINIMUM_TILE_OVERLAP">
<span class="sig-name descname"><span class="pre">MINIMUM_TILE_OVERLAP</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#flat_bug.predictor.Predictor.MINIMUM_TILE_OVERLAP" title="Link to this definition">¶</a></dt>
<dd><p>The minimum - but not necessarily the maximum - overlap between tiles in a single layer of the pyramid. Increasing this value will increase the computation time, but may improve the detection of large instances.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.MIN_MAX_OBJ_SIZE">
<span class="sig-name descname"><span class="pre">MIN_MAX_OBJ_SIZE</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#flat_bug.predictor.Predictor.MIN_MAX_OBJ_SIZE" title="Link to this definition">¶</a></dt>
<dd><p>Defines the minimum and maximum object size as seen in a single tile. Size is defined as the square root of the pixel area of the bounding box.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.PREFER_POLYGONS">
<span class="sig-name descname"><span class="pre">PREFER_POLYGONS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#flat_bug.predictor.Predictor.PREFER_POLYGONS" title="Link to this definition">¶</a></dt>
<dd><p>Whether to prefer representing the instance segmentation using polygons instead of masks. This is a much more compact representation, but cannot represent complex shapes (like holes in the mask), only concave polygons.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.SCORE_THRESHOLD">
<span class="sig-name descname"><span class="pre">SCORE_THRESHOLD</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#flat_bug.predictor.Predictor.SCORE_THRESHOLD" title="Link to this definition">¶</a></dt>
<dd><p>The score threshold for the predictions. TODO: This should be called CONFIDENCE_THRESHOLD.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.TILE_SIZE">
<span class="sig-name descname"><span class="pre">TILE_SIZE</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#flat_bug.predictor.Predictor.TILE_SIZE" title="Link to this definition">¶</a></dt>
<dd><p>The size of the tiles to split the image into. This is defined by the model and should probably not be changed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.TIME">
<span class="sig-name descname"><span class="pre">TIME</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#flat_bug.predictor.Predictor.TIME" title="Link to this definition">¶</a></dt>
<dd><p>Whether to time the different parts of the prediction process. Enabling this will print a verbose output of the timing of the different parts of the prediction process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.pyramid_predictions">
<span class="sig-name descname"><span class="pre">pyramid_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_increment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.6666666666666666</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_before</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#flat_bug.predictor.TensorPredictions" title="flat_bug.predictor.TensorPredictions"><span class="pre">TensorPredictions</span></a></span></span><a class="headerlink" href="#flat_bug.predictor.Predictor.pyramid_predictions" title="Link to this definition">¶</a></dt>
<dd><p>Performs inference on an image at multiple scales and returns the predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>Union</em><em>[</em><em>torch.Tensor</em><em>, </em><em>str</em><em>]</em>) – The image to run inference on. If a string is given, the image is read from the path.
If it is a <cite>torch.Tensor</cite>, the path must be provided. We assume that floating point images are in the range [0, 1] and integer images are in the range [0, integer_type_max]. (see <a class="reference external" href="https://github.com/pytorch/vision/blob/6d7851bd5e2bedc294e40e90532f0e375fcfee04/torchvision/transforms/_functional_tensor.py#L66">https://github.com/pytorch/vision/blob/6d7851bd5e2bedc294e40e90532f0e375fcfee04/torchvision/transforms/_functional_tensor.py#L66</a>)</p></li>
<li><p><strong>path</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – The path to the image. Defaults to None. Must be provided if <cite>image</cite> is a <cite>torch.Tensor</cite>.</p></li>
<li><p><strong>scale_increment</strong> (<em>float</em><em>, </em><em>optional</em>) – The scale increment to use when resizing the image. Defaults to 2/3.</p></li>
<li><p><strong>scale_before</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – The scale to apply before running inference. Defaults to 1.</p></li>
<li><p><strong>single_scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to run inference on a single scale. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The predictions for the image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#flat_bug.predictor.TensorPredictions" title="flat_bug.predictor.TensorPredictions">TensorPredictions</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flat_bug.predictor.Predictor.set_hyperparameters">
<span class="sig-name descname"><span class="pre">set_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#flat_bug.predictor.Predictor.set_hyperparameters" title="Link to this definition">¶</a></dt>
<dd><p>Mutably set the hyperparameters for the predictor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – The hyperparameters to set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This object (mutated with the new hyperparameters).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="trainers.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Trainers</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="nms.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Non-maximum suppression</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Asger Svenning, Quentin Geissmann
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Predictor</a><ul>
<li><a class="reference internal" href="#tensorpredictions"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorPredictions</span></code></a><ul>
<li><a class="reference internal" href="#flat_bug.predictor.TensorPredictions"><code class="docutils literal notranslate"><span class="pre">TensorPredictions</span></code></a><ul>
<li><a class="reference internal" href="#flat_bug.predictor.TensorPredictions.contour_to_image_coordinates"><code class="docutils literal notranslate"><span class="pre">TensorPredictions.contour_to_image_coordinates()</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.TensorPredictions.contours"><code class="docutils literal notranslate"><span class="pre">TensorPredictions.contours</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.TensorPredictions.fix_boxes"><code class="docutils literal notranslate"><span class="pre">TensorPredictions.fix_boxes()</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.TensorPredictions.flip"><code class="docutils literal notranslate"><span class="pre">TensorPredictions.flip()</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.TensorPredictions.load"><code class="docutils literal notranslate"><span class="pre">TensorPredictions.load()</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.TensorPredictions.non_max_suppression"><code class="docutils literal notranslate"><span class="pre">TensorPredictions.non_max_suppression()</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.TensorPredictions.offset_scale_pad"><code class="docutils literal notranslate"><span class="pre">TensorPredictions.offset_scale_pad()</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.TensorPredictions.plot"><code class="docutils literal notranslate"><span class="pre">TensorPredictions.plot()</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.TensorPredictions.save"><code class="docutils literal notranslate"><span class="pre">TensorPredictions.save()</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.TensorPredictions.serialize"><code class="docutils literal notranslate"><span class="pre">TensorPredictions.serialize()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id1"><code class="xref py py-class docutils literal notranslate"><span class="pre">Predictor</span></code></a><ul>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor"><code class="docutils literal notranslate"><span class="pre">Predictor</span></code></a><ul>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.BATCH_SIZE"><code class="docutils literal notranslate"><span class="pre">Predictor.BATCH_SIZE</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.EDGE_CASE_MARGIN"><code class="docutils literal notranslate"><span class="pre">Predictor.EDGE_CASE_MARGIN</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.EXPERIMENTAL_NMS_OPTIMIZATION"><code class="docutils literal notranslate"><span class="pre">Predictor.EXPERIMENTAL_NMS_OPTIMIZATION</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.HYPERPARAMETERS"><code class="docutils literal notranslate"><span class="pre">Predictor.HYPERPARAMETERS</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.IOU_THRESHOLD"><code class="docutils literal notranslate"><span class="pre">Predictor.IOU_THRESHOLD</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.MAX_MASK_SIZE"><code class="docutils literal notranslate"><span class="pre">Predictor.MAX_MASK_SIZE</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.MINIMUM_TILE_OVERLAP"><code class="docutils literal notranslate"><span class="pre">Predictor.MINIMUM_TILE_OVERLAP</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.MIN_MAX_OBJ_SIZE"><code class="docutils literal notranslate"><span class="pre">Predictor.MIN_MAX_OBJ_SIZE</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.PREFER_POLYGONS"><code class="docutils literal notranslate"><span class="pre">Predictor.PREFER_POLYGONS</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.SCORE_THRESHOLD"><code class="docutils literal notranslate"><span class="pre">Predictor.SCORE_THRESHOLD</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.TILE_SIZE"><code class="docutils literal notranslate"><span class="pre">Predictor.TILE_SIZE</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.TIME"><code class="docutils literal notranslate"><span class="pre">Predictor.TIME</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.pyramid_predictions"><code class="docutils literal notranslate"><span class="pre">Predictor.pyramid_predictions()</span></code></a></li>
<li><a class="reference internal" href="#flat_bug.predictor.Predictor.set_hyperparameters"><code class="docutils literal notranslate"><span class="pre">Predictor.set_hyperparameters()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>